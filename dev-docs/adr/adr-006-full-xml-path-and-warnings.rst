ADR-006: XMLパスと警告メッセージ
================================

ステータス
----------

クローズ（完全実装、テスト完了）

文脈
----

XMLからExcelへの変換プロセスにおいて、以下の課題がありました：

1. XMLのパス記述が中間を省略した形式で、構造が不明確
2. シート名の長さ制限（31文字）のチェックが不十分
3. 型の不一致の検出と通知が必要

決定
----

以下の変更を実装することを決定しました：

1. XMLパスの記述

   -  中間を省略せず、フルパスで記述
   -  より明確な構造の把握が可能に

2. エラー処理メカニズム

   -  シート名が31文字を超える場合はエラーとして処理
   -  日本語によるエラーメッセージを提供
   -  ConfigurationErrorとして実装

3. ログ機能

   -  詳細なデバッグ情報を出力
   -  変換プロセスの追跡を容易に
   -  エラー情報の階層化

結果
----

メリット
~~~~~~~~

-  XMLの構造がより明確に
-  潜在的な問題（シート名の長さ）を早期に検出可能
-  デバッグと問題追跡が容易に
-  日本語でのエラー通知によりユーザビリティが向上

デメリット
~~~~~~~~~~

-  設定ファイルがより冗長に（フルパスの使用により）
-  エラーチェックにより、処理が若干遅くなる可能性

実装例
~~~~~~

設定ファイル（TOML）：

.. code:: toml

   [mapping."root.orders.domestic.order"]
   sheet_name = "注文一覧"

   [mapping."root.orders.domestic.order".columns]
   "id" = "注文ID"
   "date" = "注文日"

エラーメッセージ例：

::

   エラー: シート名 'very.long.path.that.exceeds.excel.sheet.name.limit' が31文字を超えています
   エラー: XMLファイルの解析に失敗しました

実装完了
--------

1. エラー処理機能

   -  シート名の長さ制限チェック
   -  日本語エラーメッセージ
   -  エラー階層の整理

2. ログ機能の強化

   -  デバッグ情報の充実
   -  エラートレースの改善

3. テスト

   -  エラーケースのテスト追加
   -  メッセージの検証
   -  すべてのテストが成功

注意点
------

1. エラー処理の一貫性

   -  すべてのエラーメッセージを日本語で提供
   -  エラーレベルの適切な設定

2. パフォーマンスへの影響

   -  エラーチェックのタイミング最適化
   -  ログ出力の効率化

関連事項
--------

-  ADR-005: XMLパスとシート名の取り扱い
-  ADR-007: シートデータ統合戦略
