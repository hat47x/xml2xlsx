ADR-005: XMLパスとシート名の取り扱い
====================================

ステータス
----------

クローズ（完全実装、テスト完了）

文脈
----

XMLのパス構造をExcelのシート名に変換する際に、以下の課題が発生しています：

1. パスの長さがExcelのシート名制限（31文字）を超える可能性
2. 同じパスが複数回出現する可能性
3. 特殊文字やスペースの扱い

決定事項
--------

基本方針
~~~~~~~~

1. XMLパスを「.」で区切って表現

   -  例: ``root.orders.order.items.item``
   -  階層構造を明確に表現

2. シート名の制限

   -  Excelの31文字制限を厳密にチェック
   -  制限を超える場合はエラーとして処理
   -  ユーザーが設定ファイルで適切なシート名を指定する必要がある

3. シート名の重複防止

   -  設定ファイルでの明示的なシート名指定を優先
   -  デフォルトではパスの最後のセグメントを使用

エラー処理
~~~~~~~~~~

1. シート名の長さチェック

   -  設定読み込み時に検証
   -  実行時の動的生成時もチェック
   -  明確なエラーメッセージを提供（日本語）

2. ユーザーへのガイダンス

   -  制限事項を明確に文書化
   -  設定例の提供
   -  エラーメッセージでの対処方法の提示

結果
----

1. より堅牢なシート名の処理

   -  早期のエラー検出
   -  明確なエラーメッセージ

2. ユーザー体験の向上

   -  設定による柔軟なカスタマイズ
   -  わかりやすいエラーメッセージ

影響
----

1. 設定ファイルの要件

   -  シート名を明示的に指定する必要性
   -  長いパスの場合の対処

2. エラー処理

   -  より厳密なバリデーション
   -  エラーメッセージの改善

注意点
------

1. 既存の設定ファイルの互換性
2. エラーメッセージの明確さ
3. ユーザードキュメントの更新

実装完了
--------

-  シート名の31文字制限チェックを実装
-  エラーメッセージの日本語化完了
-  すべてのテストケースが成功
-  ドキュメントを更新済み
