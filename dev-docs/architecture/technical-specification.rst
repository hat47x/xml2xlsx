技術仕様
========

システムアーキテクチャ
-----------------

.. graphviz::

   digraph architecture {
      rankdir=LR;
      node [shape=box, style=rounded];
      
      xml [label="XMLファイル"];
      parser [label="XMLパーサー"];
      converter [label="データ変換"];
      dataframe [label="データフレーム"];
      excel [label="Excelファイル"];
      
      xml -> parser;
      parser -> converter;
      converter -> dataframe;
      dataframe -> excel;
   }

データフロー
---------

1. XML入力処理

   * ElementTreeによるパース
   * パス解析と要素マッピング
   * CDATA処理

2. データ変換

   * 設定に基づく要素抽出
   * 属性とテキストの正規化
   * 重複データの排除

3. Excel出力

   * シート名の検証
   * カラム名のマッピング
   * データ型の変換

制約事項
------

Excelの制約
^^^^^^^^^^

* シート名の最大長: 31文字
* シート名の使用不可文字: []/\?*
* 最大行数: 1,048,576
* 最大列数: 16,384

XMLの制約
^^^^^^^^

* 対応文字エンコーディング: UTF-8
* CDATA対応
* 最大ファイルサイズ: メモリに依存

メモリ使用量
---------

* 基本使用量: 入力XMLの約2倍
* 変換時の一時使用: 対象データの約3倍
* 推奨最小メモリ: 1GB

パフォーマンス
-----------

処理速度の目安：

* 小規模ファイル（<1MB）: 1秒以内
* 中規模ファイル（1-10MB）: 10秒以内
* 大規模ファイル（>10MB）: データサイズに比例

エラー処理
--------

検証エラー
^^^^^^^^

* XMLスキーマ違反
* 無効なパス指定
* シート名制約違反

実行時エラー
^^^^^^^^^

* メモリ不足
* ファイルアクセスエラー
* 変換処理の例外

ログ出力
------

* INFO: 通常の処理状況
* WARNING: 処理は継続可能な問題
* ERROR: 致命的なエラー
* DEBUG: 詳細なデバッグ情報
