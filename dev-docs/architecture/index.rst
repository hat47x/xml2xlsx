アーキテクチャ概要
==============

このセクションでは、xml2xlsxの技術アーキテクチャについて説明します。

システム構成
-----------

.. code-block:: text

    +----------------+     +----------------+     +----------------+
    |                |     |                |     |                |
    |   XML入力      |---->|   XMLパーサー   |---->|  データ変換    |
    |                |     |                |     |                |
    +----------------+     +----------------+     +----------------+
                                                         |
    +----------------+     +----------------+            |
    |                |     |                |            |
    |   Excel出力    |<----|  データフレーム  |<-----------+
    |                |     |                |
    +----------------+     +----------------+

主要コンポーネント
---------------

1. XMLパーサー
^^^^^^^^^^^

* xml.etree.ElementTree使用
* 階層構造の解析
* CDATA対応
* エラー処理

2. データ変換
^^^^^^^^^^

* 設定ベースのマッピング
* エンティティの抽出
* データの正規化
* 重複排除

3. データフレーム処理
^^^^^^^^^^^^^^^

* pandas使用
* メモリ効率の最適化
* カラム管理
* データ型の一貫性

4. Excel出力
^^^^^^^^^

* openpyxl使用
* シート名の管理
* 出力形式の制御
* エラー処理

技術仕様
--------

詳細な技術仕様については、以下のドキュメントを参照してください：

.. toctree::
   :maxdepth: 2

   basic-design
   detailed-design
   technical-specification

設計原則
--------

1. シンプルさ
^^^^^^^^^^

* 明確な責任分担
* 最小限の依存関係
* 理解しやすいコード

2. 堅牢性
^^^^^^^

* エラーの適切な処理
* データの整合性確保
* リソースの効率的な利用

3. 拡張性
^^^^^^^

* モジュール化された設計
* プラグイン可能なアーキテクチャ
* 設定による制御

実装の詳細
----------

* :doc:`basic-design` - 基本設計と主要な決定事項
* :doc:`detailed-design` - 詳細設計と実装の詳細
* :doc:`technical-specification` - 技術仕様と制約条件

開発への参加
-----------

アーキテクチャの変更を提案する際は、以下の手順に従ってください：

1. 既存のADRを確認
2. 影響範囲の分析
3. 新しいADRの作成
4. レビューと承認プロセス

関連情報
--------

* :doc:`../guides/development-style` - 開発スタイルガイド
* :doc:`../guides/testing` - テストガイド
* :doc:`../adr/index` - アーキテクチャ決定記録